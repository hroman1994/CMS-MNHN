<html>
    <head>
    </head>
    <body>
        <div class="mt-3 shadow p-3 mb-5 bg-white rounded" style="margin: 5%;" *ngIf="lista_helechos == true">
            <div class="row justify-content-center">
                
                    <h4>Administración Helechos</h4>
                
                
                <div class="row justify-content-center" style="min-width: 1400px; overflow: auto;">
                    <div class="col-11 mt-2">
                        <table class="table table-hover" >
                            <thead>
                                <tr class="form-group" style="font-size:smaller;">
                                    <td><input [(ngModel)]="txtrecordNumber" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtPersonName" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtDateSupplied" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtCollectors" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtCountryName" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtLocality" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtFamily" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtGenus" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                    <td><input [(ngModel)]="txtSpecies" (ngModelChange)="FiltrarRango()" type="text" class="form-control"></td>
                                </tr>
                                <tr>
                                    
                                    <th>RecordNumber</th>
                                    <th>PersonName</th>
                                    <th>Fecha</th>
                                    <th>Collectors</th>
                                    <th>Country</th>
                                    <th>Locality</th>
                                    <th>Family</th>
                                    <th>Genus</th>
                                    <th>Species</th>
                                    <th>Estado</th>
                                    <th>Datos</th>
                                    <th>Imagen</th>
        
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let x of Helechos_Filtro | paginate:{id:'pagination', itemsPerPage:10,currentPage:pageActual}" class="border-top border-bottom">
                                    <td>{{x.recordNumber}}</td>
                                    <td>{{x.PersonName}}</td>
                                    <td>{{x.DateSupplied.split(' ')[0]}}</td>
                                    <td>{{x.Collectors}}</td>
                                    <td>{{x.CountryName}}</td>
                                    <td>{{x.Locality}}</td>
                                    <td>{{x.Family}}</td>
                                    <td>{{x.Genus}}</td>
                                    <td>{{x.Species}}</td>
                                    <td *ngIf= "x.Estado == 0"><button type="button" class="btn btn-success" (click)="CambiarEstadoHelecho(x.recordNumber, 1,x.IMAGEN)">Publicar</button></td>
                                    <td *ngIf= "x.Estado == 1"><button type="button" class="btn btn-danger" (click)="CambiarEstadoHelecho(x.recordNumber, 0,x.IMAGEN)">Quitar</button></td>
                                    <td><button type="button" class="btn btn-warning" (click)="TraerDetalleHelecho(x.recordNumber)">Editar</button></td>
                                    <td *ngIf="x.IMAGEN == 1"><button type="button" class="btn btn-success" (click)="AbrirModalEditarImagen(x.recordNumber, x.IMAGEN)">Editar</button></td>
                                    <td *ngIf="x.IMAGEN == 0"><button type="button" class="btn btn-danger" (click)="AbrirModalEditarImagen(x.recordNumber, x.IMAGEN)">Editar</button></td>

                                </tr>
                            </tbody>
                        </table>
                        <div class="col-md-12 offset-md-2" *ngIf="helechos.length > 10">
                            <pagination-controls id='pagination' (pageChange)="pageActual=$event"></pagination-controls>
                        </div>
                    </div>
    
                </div>
            </div>
        </div>
    </body>
</html>

<div *ngIf = "lista_helechos == false">
    <div class="mt-3 shadow p-3 mb-5 bg-white rounded" style="margin: 20%;">
        <div class="row">
            <div class="col-9">
                <h3 class="ml-2">Información Helecho N°: {{recordNumber}}</h3>
            </div>
            <div class="col-3">
                <button type="button" class="btn btn-success ml-3" (click)="ReiniciarDetHelecho()">Volver</button>
                <button type="button" class="btn btn-warning ml-3" (click)="EditarHelecho()">Guardar cambios</button>
            </div>
        </div>
        <div class="row">
            <div class="col form-group">
                <label for="Genus"><strong>Genus:</strong></label>
                <input id = "Genus" type="text" class="form-control" [(ngModel)]="Genus">
                
                <label for="GenusQualifier"><strong>GenusQualifier: </strong></label>
                <input id = "GenusQualifier" type="text" class="form-control" [(ngModel)]="GenusQualifier">

                <label for="Species"><strong>Species: </strong></label>
                <input  id="Species" type="text" class="form-control" [(ngModel)]="Species">

                <label for="Author"><strong>Author: </strong></label>
                <input  id="Author" type="text" class="form-control" [(ngModel)]="Author">

                <label for="InfraSpecificRank"><strong>InfraSpecificRank: </strong></label>
                <input  id="InfraSpecificRank" type="text" class="form-control" [(ngModel)]="InfraSpecificRank">

                <label for="InfraSpecificEpithet"><strong>InfraSpecificEpithet: </strong></label>
                <input  id="InfraSpecificEpithet" type="text" class="form-control" [(ngModel)]="InfraSpecificEpithet">

                <label for="InfraSpecificAuthor"><strong>InfraSpecificAuthor: </strong></label>
                <input  id="InfraSpecificAuthor" type="text" class="form-control" [(ngModel)]="InfraSpecificAuthor">

                <label for="PlantNameCode"><strong>PlantNameCode: </strong></label>
                <input  id="PlantNameCode" type="text" class="form-control" [(ngModel)]="PlantNameCode">
    
                <label for="Identifier"><strong>Identifier: </strong></label>
                <input  id="Identifier" type="text" class="form-control" [(ngModel)]="Identifier">


            </div>
            <div class="col form-group">

                <label for="TypeStatus"><strong>TypeStatus: </strong></label>
                <input  id="TypeStatus" type="text" class="form-control" [(ngModel)]="TypeStatus">

                <label for="Project"><strong>Project: </strong></label>
                <input  id="Project" type="text" class="form-control" [(ngModel)]="Project">

                <label for="InstitutionCode"><strong>InstitutionCode: </strong></label>
                <input  id="InstitutionCode" type="text" class="form-control" [(ngModel)]="InstitutionCode">

                <label for="PersonName"><strong>PersonName: </strong></label>
                <input  id="PersonName" type="text" class="form-control" [(ngModel)]="PersonName">

                <label for="DateSupplied"><strong>DateSupplied: </strong></label>
                <input  id="DateSupplied" type="text" class="form-control" [(ngModel)]="DateSupplied">

                <label for="Collectors"><strong>Collectors: </strong></label>
                <input  id="Collectors" type="text" class="form-control" [(ngModel)]="Collectors">

                <label for="DateLastModified"><strong>DateLastModified: </strong></label>
                <input  id="DateLastModified" type="text" class="form-control" [(ngModel)]="DateLastModified">

                <label for="UnitTypeStatus"><strong>UnitTypeStatus: </strong></label>
                <input  id="UnitTypeStatus" type="text" class="form-control" [(ngModel)]="UnitTypeStatus">

                <label for="CountryName"><strong>CountryName: </strong></label>
                <input  id="CountryName" type="text" class="form-control" [(ngModel)]="CountryName">

            </div>

            <div class="col form-group">

                <label for="Locality"><strong>Locality: </strong></label>
                <input  id="Locality" type="text" class="form-control" [(ngModel)]="Locality">

                <label for="UnitTypeStatus"><strong>UnitTypeStatus: </strong></label>
                <input  id="UnitTypeStatus" type="text" class="form-control" [(ngModel)]="UnitTypeStatus">

                <label for="RelatedUnitID"><strong>RelatedUnitID: </strong></label>
                <input  id="RelatedUnitID" type="text" class="form-control" [(ngModel)]="RelatedUnitID">

                <label for="Notes"><strong>Notes: </strong></label>
                <input  id="Notes" type="text" class="form-control" [(ngModel)]="Notes">

                <label for="Family"><strong>Family: </strong></label>
                <input  id="Family" type="text" class="form-control" [(ngModel)]="Family">

            </div>
        </div>
    </div>
</div>


<div class="mt-3 shadow p-3 mb-5 bg-white rounded" style="margin: 20%;" *ngIf = "lista_helechos == false">
    <div class="row">
        <div class="col-8">
            <h3 class="ml-3">Categorias</h3>
        </div>
        <div class="col-2">
            <ng-select [(ngModel)]="cat">
                <ng-option  [value]="-1" >Seleccionar</ng-option>
                <ng-option *ngFor="let item of categorias_b" [value]="item">{{item.GRUPO_NOMBRE}}</ng-option>
            </ng-select>
        </div>
        <div class="col-1">
            <button type="button" class="btn btn-warning" (click)="Agregar()">Añadir</button>
        </div>
        
    </div>
    <div class="row form-group">
        <div class="col-12 ">
            <table class="table table-hover">
                <tr>
                    <th>Categoria</th>
                    <th>Eliminar</th>
                </tr>
                <tr *ngFor="let x of categorias"  class="border-top border-bottom">
                    <th>{{x.GRUPO_NOMBRE}}</th>
                    <th><button type="button" class="btn btn-danger" (click)="Eliminar(x)">Eliminar</button></th>
                </tr>
                

            </table>
            

        </div>
    </div>
</div>

<div class="mt-3 shadow p-3 mb-5 bg-white rounded" style="margin: 20%;" *ngIf = "lista_helechos == false">
    <div class="row">
        <h3 class="ml-3">Mapa</h3>
    </div>
    <div class="row form-group">
        <div class="col-12 ">
            <label for="Latitud"><strong>Latitud: </strong></label>
            <input  id="Latitud" type="float" class="form-control" [(ngModel)]="lat">
    
            <label for="Longitud"><strong>Longitud: </strong></label>
            <input  id="Longitud" type="float" class="form-control" [(ngModel)]="lon">

            <label for="Visualizacion"><strong>Visualizacion: </strong></label>
            <ng-select 
                [items]="mapa"
                bindLabel="desc"
                bindValue="id"
                placeholder="Seleccionar"
                [(ngModel)]=Hd_loc
                style="width: 80%;"
            ></ng-select>

        </div>
    </div>
</div>

<div id="ModalImagen" class="modal" style="z-index: 10001;">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close icons" id="close" (click)="CerrarModal('ModalImagen')">&times;</span>
        </div>
        <div class="modal-body">
            <div class="row justify-content-center mt-3">
                <h4 id="TituloImagen"></h4>
            </div>
            <div *ngIf="loading_imagen_2==true" class="mt-3">
                <div class="row justify-content-center" style="margin-top: 10%;">
                    <img src="assets/Spiner.gif" alt="">
                </div>
            </div>
            <div class="row justify-content-center mt-3">
                <h3 class="ml-3">Imagen</h3>
            </div>
            <div class="row justify-content-center mt-4" *ngIf="loading_imagen_2==false">
                <div class="col-4">
                    <img [src]="getSafeUrl()" style="width: 100%;">
                </div>
            </div>
            <div *ngIf="loading_imagen==false">
                <div class="row justify-content-center mt-3">
                    <input type="file" #archivo_helechos (change) = "CargandoArchivo($event)">
                </div>
                <div class="row justify-content-center mt-3">
                    <button type="button" class="btn btn-danger" (click) = "cargarImagen()">Cargar</button>
                </div>  
            </div>

            <div *ngIf="loading_imagen==true">
                <div class="row justify-content-center" style="margin-top: 10%;">
                    <img src="assets/Spiner.gif" alt="">
                </div>
            </div>

                         
        </div>
    </div>
</div>








<div id="ModalAlert" class="modal" style="z-index: 10001;">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close icons" id="close" (click)="CerrarModalAlert()">&times;</span>
        </div>
        <div class="modal-body">
            <h5 style="text-align:center; color: black; font-size: large;">{{alerta}}</h5>
        </div>
    </div>
</div>
